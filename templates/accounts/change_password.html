{% extends 'base.html' %}
{% block title %}Cambiar Contraseña - Gestor de Servicios{% endblock %}
{% block content %}

<!-- Breadcrumb -->
<nav aria-label="breadcrumb" class="mb-4">
  <ol class="breadcrumb">
    <li class="breadcrumb-item">
      <a href="/" class="text-decoration-none">
        <i class="bi bi-house me-1"></i>Inicio
      </a>
    </li>
    <li class="breadcrumb-item">
      <a href="/accounts/profile/" class="text-decoration-none">
        <i class="bi bi-person me-1"></i>Mi Perfil
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">Cambiar Contraseña</li>
  </ol>
</nav>

<!-- Header -->
<div class="mb-4">
  <h1 class="page-title">
    <i class="bi bi-shield-lock me-2"></i>Cambiar Contraseña
  </h1>
  <p class="text-muted mb-0">Actualiza tu contraseña para mantener tu cuenta segura</p>
</div>

<div class="row justify-content-center">
  <div class="col-12 col-md-8 col-lg-6">
    <!-- Formulario -->
    <div class="card shadow-lg border-0">
      <div class="card-header">
        <h5 class="mb-0">
          <i class="bi bi-key me-2"></i>Nueva Contraseña
        </h5>
      </div>
      <div class="card-body p-4">
        <form method="post" class="needs-validation" novalidate>
          {% csrf_token %}
          
          <div class="mb-4">
            <label for="{{ form.old_password.id_for_label }}" class="form-label fw-medium">
              <i class="bi bi-lock me-1"></i>Contraseña Actual *
            </label>
            <input type="password" 
                   name="old_password" 
                   class="form-control" 
                   id="{{ form.old_password.id_for_label }}"
                   placeholder="Ingresa tu contraseña actual"
                   required>
            {% if form.old_password.errors %}
              <div class="invalid-feedback d-block">
                {{ form.old_password.errors.0 }}
              </div>
            {% endif %}
          </div>

          <div class="mb-4">
            <label for="{{ form.new_password1.id_for_label }}" class="form-label fw-medium">
              <i class="bi bi-lock-fill me-1"></i>Nueva Contraseña *
            </label>
            <input type="password" 
                   name="new_password1" 
                   class="form-control" 
                   id="{{ form.new_password1.id_for_label }}"
                   placeholder="Ingresa tu nueva contraseña"
                   required>
            {% if form.new_password1.errors %}
              <div class="invalid-feedback d-block">
                {{ form.new_password1.errors.0 }}
              </div>
            {% endif %}
          </div>

          <div class="mb-4">
            <label for="{{ form.new_password2.id_for_label }}" class="form-label fw-medium">
              <i class="bi bi-check-circle me-1"></i>Confirmar Nueva Contraseña *
            </label>
            <input type="password" 
                   name="new_password2" 
                   class="form-control" 
                   id="{{ form.new_password2.id_for_label }}"
                   placeholder="Confirma tu nueva contraseña"
                   required>
            {% if form.new_password2.errors %}
              <div class="invalid-feedback d-block">
                {{ form.new_password2.errors.0 }}
              </div>
            {% endif %}
          </div>

          {% if form.non_field_errors %}
            <div class="alert alert-danger mb-4" role="alert">
              <i class="bi bi-exclamation-triangle me-2"></i>
              {{ form.non_field_errors.0 }}
            </div>
          {% endif %}

          <!-- Botones -->
          <div class="d-flex justify-content-end gap-2 pt-3 border-top">
            <a href="/accounts/profile/" class="btn btn-secondary">
              <i class="bi bi-x-circle me-2"></i>Cancelar
            </a>
            <button type="submit" class="btn btn-primary">
              <i class="bi bi-check-circle me-2"></i>Cambiar Contraseña
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Información de seguridad -->
    <div class="card mt-4 border-0 bg-light">
      <div class="card-body p-4">
        <h6 class="fw-bold mb-3">
          <i class="bi bi-info-circle me-2"></i>Consejos de Seguridad
        </h6>
        <div class="row g-3">
          <div class="col-12">
            <div class="d-flex align-items-start">
              <i class="bi bi-shield-check text-success me-3 mt-1"></i>
              <div>
                <h6 class="mb-1">Usa una contraseña fuerte</h6>
                <small class="text-muted">Combina letras mayúsculas, minúsculas, números y símbolos</small>
              </div>
            </div>
          </div>
          <div class="col-12">
            <div class="d-flex align-items-start">
              <i class="bi bi-eye-slash text-primary me-3 mt-1"></i>
              <div>
                <h6 class="mb-1">Mantén tu contraseña privada</h6>
                <small class="text-muted">No compartas tu contraseña con nadie más</small>
              </div>
            </div>
          </div>
          <div class="col-12">
            <div class="d-flex align-items-start">
              <i class="bi bi-arrow-repeat text-info me-3 mt-1"></i>
              <div>
                <h6 class="mb-1">Cambia regularmente</h6>
                <small class="text-muted">Actualiza tu contraseña periódicamente para mayor seguridad</small>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
  .form-control:focus {
    border-color: var(--primary-blue-light);
    box-shadow: 0 0 0 0.25rem rgba(59, 130, 246, 0.15);
  }
  
  .btn-primary:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
  }
</style>
{% endblock %}